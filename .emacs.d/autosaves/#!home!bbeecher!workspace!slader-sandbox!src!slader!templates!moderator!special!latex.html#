{% extends "edit/edit-base.html" %}{% load moderatortags %}
{% load main_tags common_tags solutions_tags %}

{% block title %}
Moderate exercise {{exname}} in textbook  {{ textbook.title }}
{% endblock %}

{% block startjs %}
<link rel="stylesheet" type="text/css" href="/media/css/contributor_editing.css" />
<link rel="stylesheet" type="text/css" href="/media/css/moderator.css" />
<link rel="stylesheet" type="text/css" href="/media/css/eq_editor.css" />
    <link href="/media/css/textbook.css" rel="stylesheet" type="text/css" />
    <link href="/media/css/solution.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="http://jquery-ui.googlecode.com/svn/tags/latest/themes/base/jquery-ui.css" type="text/css" media="all" />
    <link rel="stylesheet" type="text/css" href="/media/css/contributor_editing.css" />
    <link rel="stylesheet" type="text/css" href="/media/css/moderator.css" />
    <link rel="stylesheet" type="text/css" href="/media/css/global.css" />
    <link href="/media/css/solution.css" rel="stylesheet" type="text/css" media="screen" />

    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js" type="text/javascript"></script>
    <script src="/media/js/ajaxfileupload.js" type="text/javascript"></script>
    <script src="/media/js/slader_textbook.js" type="text/javascript"></script>
    <script src="/media/js/slader_solution_tools.js" type="text/javascript"></script>
    <script src="/media/js/jquery.tmpl.min.js" type="text/javascript"></script>
    <script src="/media/js/slader_row_slider.js" type="text/javascript"></script>    
    <script src="/media/js/slader_equation_editor.js" type="text/javascript"></script>
    <script src="/media/js/slader_lightbox.js" type="text/javascript"></script>

    <script type="text/javascript">
      $(document).ready(function(){
              $('#eqeditor').equationEditor('initEditor', {{solution.data.id}});
      });
    </script>

    <script type="text/javascript">
    
    
    $(document).ready(function(){
        {% if preview %}
        if ($('#further-review-specialist').val() == $('input[name=further-review]:radio:checked').val()){
            $("#notesdiv").hide();
            $("#reassign").show();
            $("#reassign-block").show();
        }
        else if ($('#further-review-user').val() == $('input[name=further-review]:radio:checked').val()){
            $("#reassign").hide();
            $("#notesdiv").show();
            }
        else{
            $("#reassign").hide();
            $("#notesdiv").hide();
        };
    
        $('input[name=further-review]:radio').change(function(){
            if ($('#further-review-specialist').val() == $('input[name=further-review]:radio:checked').val()){
                $("#notesdiv").hide();
                $("#reassign").show();
                $("#reassign-block").show();
            }
            else if ($('#further-review-user').val() == $('input[name=further-review]:radio:checked').val()){
                $("#reassign").hide();
                $("#notesdiv").show();
            }
            else{
                $("#reassign").hide();
                $("#notesdiv").hide();
            }});
        {% endif %}
    });
    </script>
{% endblock %}

{% block content %}

{% show_moderator_stats %}

{% include "moderator/includes/solution_details.html" %}

{% if closed %}
<h1 class="closed"> This Review has already been processed </h1>
{% endif %}

{% if notes %}
<div id="oldnotes">
    <h3><p>Notes by Previous Reviewers</p></h3>
    <ol>
    {% for note in notes %}
        <li class="oldnote">
            {{ note }}
        </li>
    {% endfor %}
    </ol>
</div>
{% endif %}

<div id="solutionContent">
		
    <!-- wrapper start -->
    <div class="wrapper">
    
        <div id="navColumn">   
        </div>
        
        <div id="contentColumn">

            <div id="solutionWrapper" class="solutionEditing solutionIncomplete">

                <h2>
                    Edit your solution below
                    <button class="column columnRow">&#43; column</button>
                    <button class="row columnRow">&#43; row</button>
                </h2>

                <!-- solutions start -->
                <div id="eqeditor">
                </div>

                <!-- solutions end -->
            </div>

            {% load_moderator_tools %}

            <div>
              {% if preview %}
              <h5>Select what action should happen next</h5>
              <form action="." method="post" id="latexForm">
                <div>
                  <input type="radio" name="further-review" value="ready" id="ready" />
                  <label for="ready">This solution is <b>ready</b> to appear on the website</label>
                </div>
                <div>
                  <input type="radio" name="further-review" value="user" id="further-review-user" checked="checked" />
                  <label for="further-review-user">The <b>user</b> needs to take further action on this item</label>
                </div>
                <div>
                  <input type="radio" name="further-review" value="specialist" id="further-review-specialist" />
                  <label for="further-review-specialist">A <b>specialist</b> needs to look at this item (select at least one specialty below)</label>
                </div>
                <div id="reassign">
                  {% reassign %}
                </div>
                <div id="notesdiv">
                  <br>
                  <label for="notes">Notes:</label><br>
                  <textarea id="notes" name="notes"></textarea>
                  <br>
                </div>
                <br />
                <input type="submit" value="submit" name="Finish" id="specialSubmitFinal"/>
                <br />
                <br />
              </form>
              {% else %}
              <form action="." method="post" id="latexForm">
                <div id="specialSubmit">
                  <input type="submit" value="Finished editing exercise" name="Finalize" id="specialSubmitFinal"/>
                  <input type="submit" value="Cancel this Review!" name="cancel" id="special-submit-cancel"/>
                  <input type="submit" value="Reject this solution!" name="reject" id="special-submit-reject"/>
                </div>
              </form>
              {% endif %}
            </div>

            {% block posteditor %}
            {% endblock posteditor %}    
        </div>
    </div>
    <!-- wrapper end -->
</div>

{% endblock %}
